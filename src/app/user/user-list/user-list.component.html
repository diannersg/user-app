<div class="flex flex-col h-full w-full items-center bg-gray-900 py-10 px-5">

  <div class="flex justify-between items-center mb-5 text-2xl text-gray-400 w-full md:w-3/5 lg:w-1/2">
    <span>Users</span>
    <mat-form-field appearance="outline" subscriptSizing="dynamic" class="bg-gray-300 rounded">
      <input matInput placeholder="Search" [formControl]="searchControl">
      <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>
  </div>

  <div class="flex flex-col flex-1 gap-5 w-full md:w-3/5 lg:w-1/2 overflow-auto">
    <div class="flex flex-col flex-1 gap-5 overflow-auto">
      <ng-container *ngIf="(filteredUsers$ | async)?.length; else noUser">
        <ng-container *ngFor="let user of filteredUsers$ | async">
          <div class="flex flex-col card p-5 cursor-pointer" [routerLink]="user.id.toString()">
            <span class="text-lg">{{user.name}}</span>
            <div class="user-details">
              <mat-icon inline>contact_mail</mat-icon>
              <span class="text-sm">{{user.email}}</span>
            </div>
            <div class="user-details">
              <mat-icon inline>smartphone</mat-icon>
              <span class="text-sm">{{user.phone}}</span>
            </div>
          </div>
        </ng-container>
      </ng-container>
    </div>
    <ng-template #noUser>
      <div class="flex h-full p-5 justify-center items-center">
        <span class="text-gray-500 italic text-center text-2xl">No user found</span>
      </div>
    </ng-template>

    <div class="flex w-full">
      <mat-paginator
        class="w-full !bg-gray-400"
        [length]="(page$ | async)?.length"
        [pageSize]="(page$ | async)?.pageSize"
        [pageIndex]="(page$ | async)?.pageIndex"
        [pageSizeOptions]="[5, 10, 25, 100]"
        (page)="handlePageEvent($event)"
        aria-label="Select page">
      </mat-paginator>
    </div>
  </div>
</div>

<ng-template #errorDialog>
  <div class="flex flex-col p-8 gap-2">
    <div class="text-2xl">Retrieve user list failed</div>
    <div class="text-xl">Try again?</div>
    <div class="flex justify-end mt-3 gap-4">
      <button mat-flat-button (click)=dialogRef?.close()>No</button>
      <button mat-flat-button (click)="dialogRef?.close(true)" color="primary">Yes</button>
    </div>
  </div>
</ng-template>
